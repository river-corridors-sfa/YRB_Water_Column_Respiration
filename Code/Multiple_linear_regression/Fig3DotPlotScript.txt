#What is this? A modified snippet of code from Matt Kaufman's original R Markdown script that ran exploratory analyses of the 2021 spatial study (manual chamber) water column respiration (ERwc) data.
#What does this code do? This piece of code generates a dot plot of all 141 ERwc sample replicates and the site means (Figure 3 in the manuscript). The dot plot is Figure 3 in the manuscript 
#Who wrote it? S. Fulton modified Matt's script to change the original plot format and axis units for use  in the manusript "Yakima River Basin Water Column Respiration is a Minor Component of River Ecosystem Respiration" (in progress) by Fulton et al.
#What is the name of Matt's code? "spatial_water_column_metabolism_for_paper.Rmd"
#Where is Matt's code: The .Rmd script can be found in the original  GitLab repo titled "water_column_respiration_2021" and can be found here: https://gitlab.pnnl.gov/sbrsfa/rc2/water_column_respiration_2021/-/tree/main/analysis_1). The original and modified code dot plot lines of code can be found on lines 118-124 and 126-134, respectively.
#How do I use it? See Matt's original code (above) to see which data files were used and how they may have been manipulated prior to making the dot plot. Code snippet should be included in Xinming's code "RC2_spatial_study_MLR_v3.R".

#dot plot figure (comparison of repilcates)
```{r message=FALSE}
#ggplot(rawdata, aes(x=SID, y=DO.slope.mgday)) + 
# stat_summary(fun=mean, geom="point", shape=18,size=3, color="red") +
#  geom_dotplot(binaxis='y', stackdir='center',binwidth = 0.002,) +
#  ylab("Respiration rate (mg O2/L*day)") + xlab("Site ID") + 
#  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),legend.position = c(0, 0))
#replot dot plot figure with new ylab and no gray background
DotPlot <- ggplot(rawdata, aes(x=SID, y=DO.slope.mgday)) + 
  stat_summary(fun=mean, geom="point", shape=18,size=3, color="red") +
  geom_dotplot(binaxis='y', stackdir='center',binwidth = 0.002,) +
  ylab(expression("ER"[wc]*" (mg O"[2]*" L"^-1*"day"^-1*")")) + xlab("Site ID") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),legend.position = c(0, 0))
DotPlotFin <- DotPlot + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))
print(DotPlotFin)